#!/usr/bin/env bash

echo "ğŸ” Ejecutando validaciones pre-commit..."

# Verificar tipos TypeScript
echo "ğŸ“ Verificando tipos TypeScript..."
npm run type-check
if [ $? -ne 0 ]; then
  echo "âŒ Error: TypeScript compilation failed"
  exit 1
fi

# Verificar linting
echo "ğŸ”§ Verificando linting..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ Error: ESLint found problems"
  exit 1
fi

# Verificar formato
echo "ğŸ¨ Verificando formato..."
npm run format:check
if [ $? -ne 0 ]; then
  echo "âŒ Error: Prettier found problems"
  exit 1
fi

# Verificar servidor de desarrollo
echo "ğŸŒ Verificando servidor de desarrollo..."
if ! curl -s http://localhost:3000 > /dev/null 2>&1; then
  echo "âš ï¸  Advertencia: Servidor de desarrollo no estÃ¡ ejecutÃ¡ndose"
  echo "ğŸ’¡ Para una verificaciÃ³n completa, ejecuta: npm run dev"
  echo "ğŸ“‹ Checklist de verificaciÃ³n en navegador:"
  echo "   - Abrir http://localhost:3000"
  echo "   - Verificar que la pÃ¡gina carga correctamente"
  echo "   - Probar funcionalidades (botones, formularios, navegaciÃ³n)"
  echo "   - Verificar responsive design"
  echo "   - Verificar que no hay errores en consola del navegador"
  echo ""
  echo "ğŸ” Para verificar automÃ¡ticamente: ./verify-browser.sh"
else
  echo "âœ… Servidor de desarrollo ejecutÃ¡ndose"
  echo "ğŸŒ Verifica en navegador: http://localhost:3000"
fi

echo "âœ… Validaciones tÃ©cnicas completadas"
echo "ğŸš€ Commit permitido (recuerda probar en navegador)"
